---
title: ER Diagram for OBD Platform
---
erDiagram
  USERS {
    INT ID PK
    VARCHAR(50) first_name
    VARCHAR(50) last_name
    VARCHAR(128) email UK
    VARCHAR(255) password_hash UK
    BOOLEAN active
    TIMESTAMP created_at
    TIMESTAMP updated_at
  }

  CARS {
    INT ID PK
    VARCHAR(17) VIN UK "Vehicle Identificacion Number"
    VARCHAR(50) brand
    VARCHAR(50) model
    VARCHAR(4) year
    TIMESTAMP created_at
    TIMESTAMP updated_at
  }

  USER_CAR {
    INT user_ID FK
    INT car_ID FK
    ENUM role "owner|mechanic"
    TIMESTAMP granted_at
    TIMESTAMP expires_at
  }

  CAR_SPECS {
    INT car_ID PK
    INT engine_cc
    VARCHAR(20) fuel_type
    VARCHAR(30) transmission
    VARCHAR(30) body_style
    JSONB json_snapshot
    TIMESTAMP created_at
    TIMESTAMP updated_at
  }

  LOGS {
    INT ID PK
    INT car_ID FK
    TIMESTAMP scanned_at
    TIMESTAMP created_at
  }

  OBD_CODES {
    INT ID PK
    VARCHAR(10) category
    VARCHAR(10) code UK
    TEXT description
    TIMESTAMP created_at
    TIMESTAMP updated_at
  }

  LOG_OBD_CODE {
    INT log_ID FK
    INT code_ID FK
    ENUM status "active|cleared"
    INT occurrence_count
    TIMESTAMP created_at
  }

  %% Relationships
  USERS ||--o{ USER_CAR : owns
  CARS ||--o{ USER_CAR : linked_to
  CARS ||--o{ LOGS : generates
  CARS ||--|| CAR_SPECS : has
  LOGS ||--o{ LOG_OBD_CODE : includes
  OBD_CODES ||--o{ LOG_OBD_CODE : referenced_by
